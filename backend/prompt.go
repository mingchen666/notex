package backend

// getTransformationPrompt returns the prompt template for each transformation type
func getTransformationPrompt(transformType string) string {
	switch transformType {
	case "summary":
		return summaryPrompt()

	case "faq":
		return faqPrompt()

	case "study_guide":
		return studyGuidePrompt()

	case "outline":
		return outlinePrompt()

	case "podcast":
		return podcastPrompt()

	case "timeline":
		return timelinePrompt()

	case "glossary":
		return glossaryPrompt()

	case "quiz":
		return quizPrompt()

	case "mindmap":
		return mindmapPrompt()

	case "infograph":
		return infographPrompt()

	case "ppt":
		return pptPrompt()

	case "custom":
		return customPrompt()

	case "insight":
		return insightPrompt()

	default:
		return defaultPrompt()
	}
}

func summaryPrompt() string {
	return `你是一个擅长创建综合摘要的专家。请根据以下来源，以{format}格式创建一个{length}摘要。
**注意：无论来源是什么语言，请务必使用中文进行回复。不要使用 ` + "```markdown" + ` 标记包裹输出。**

来源：
{sources}

请提供一个结构良好的摘要，捕捉来源中的关键信息、主要主题和重要细节。`
}

func faqPrompt() string {
	return `你是一个擅长创建常见问题解答（FAQ）文档的专家。请根据以下来源，以{format}格式生成一个全面的FAQ。
**注意：无论来源是什么语言，请务必使用中文进行回复。不要使用 ` + "```markdown" + ` 标记包裹输出。**

来源：
{sources}

创建10-15个常见问题及其详细解答，涵盖来源中的主要主题和信息。`
}

func studyGuidePrompt() string {
	return `你是一个教育专家。请根据以下来源，以{format}格式创建一个全面的学习指南。
**注意：无论来源是什么语言，请务必使用中文进行回复。不要使用 ` + "```markdown" + ` 标记包裹输出。**

来源：
{sources}

学习指南应包括：
1. 学习目标
2. 关键概念和定义
3. 重要主题和议题
4. 学习问题和练习
5. 要点总结

请针对{length}的学习课程进行格式化。`
}

func outlinePrompt() string {
	return `你是一个擅长创建结构化大纲的专家。请根据以下来源，以{format}格式创建一个详细的层级大纲。
**注意：无论来源是什么语言，请务必使用中文进行回复。不要使用 ` + "```markdown" + ` 标记包裹输出。**

来源：
{sources}

大纲应：
- 使用适当的层级结构（I, A, 1, a）
- 涵盖所有主要主题和子主题
- 包含主要部分的简要说明
- 详细程度为{length}`
}

func podcastPrompt() string {
	return `你是一个播客脚本编剧。请根据以下来源创建一个引人入胜的播客脚本。
**注意：无论来源是什么语言，请务必使用中文进行回复。不要使用 ` + "```markdown" + ` 标记包裹输出。**

来源：
{sources}

脚本应：
- 具有对话性和吸引力
- 涵盖来源中的主要主题
- 包括两位主持人讨论材料
- 口语时长约为10-15分钟
- 包含自然的过渡和提问
- 有清晰的开场白和结束语

请将其格式化为带有演讲者标签（主持人1，主持人2）和[括号]中舞台指示的播客脚本。`
}

func timelinePrompt() string {
	return `你是一个擅长创建按时间顺序排列的时间线的专家。请根据以下来源，以{format}格式创建一个时间线。
**注意：无论来源是什么语言，请务必使用中文进行回复。不要使用 ` + "```markdown" + ` 标记包裹输出。**

来源：
{sources}

按时间顺序提取和组织事件，包括：
- 日期或时间段
- 事件描述
- 涉及的关键人物
- 每个事件的重要性`
}

func glossaryPrompt() string {
	return `你是一个擅长创建术语表的专家。请根据以下来源，以{format}格式创建一个全面的术语表。
**注意：无论来源是什么语言，请务必使用中文进行回复。不要使用 ` + "```markdown" + ` 标记包裹输出。**

来源：
{sources}

包括：
- 重要术语和概念
- 清晰简洁的定义
- 来源中的上下文
- 相关术语之间的交叉引用`
}

func quizPrompt() string {
	return `你是一个创建评估材料的教育家。请根据以下来源，以{format}格式创建一个测验。
**注意：无论来源是什么语言，请务必使用中文进行回复。不要使用 ` + "```markdown" + ` 标记包裹输出。**

来源：
{sources}

测验应包括：
- 混合题型（多项选择、判断正误、简答）
- 不同难度的问题
- 答案
- 测试理解力而非仅仅是记忆力的问题

创建一个包含10-20个问题的{length}测验。`
}

func mindmapPrompt() string {
	return `你是一位资深的信息架构师和知识管理专家。请将【文本内容】提炼并转换为 Mermaid.js 的 mindmap 格式。
**注意：无论来源是什么语言，请务必使用中文进行回复。**

# 样式规范：
1. **中心主题**：必须使用 root((内容)) 格式（圆圈）。
2. **主要分支**：使用 (内容) 格式（圆角矩形）。
3. **细节节点**：使用 [内容] 格式（普通矩形）或直接写文字。

# 严格逻辑规范：
1. **仅限 mindmap 语法**：严禁使用 graph, LR, --> 等字符。
2. **内容安全**：节点内容必须精炼（10字以内），严禁包含引号。
3. **严禁解释**：只输出以 ` + "```mermaid" + ` 开头和以 ` + "```" + ` 结尾的代码块。

来源：
{sources}

# 示例：
` + "```mermaid" + `
mindmap
  root((核心主题))
    (主要分支A)
      [细节1]
      [细节2]
    (主要分支B)
      [细节3]
` + "```" + `
`
}

func infographPrompt() string {
	return `请根据提供的内容创建卡通风格的信息图，遵循以下指南：

- 手绘插画风格，横向布局（16:9宽高比）。
- 包含少量简单的卡通元素、图标或知名人物，以增强视觉趣味性和记忆点。
- 如果内容包含敏感或有版权的人物，请用视觉上相似的替代品替换；不要拒绝生成插图。
- 所有图像和文字必须严格遵循手绘风格；避免使用写实的视觉元素。
- 保持信息简洁，突出关键词和核心概念。充分利用留白来清晰强调重点。
- 除非另有说明，使用与提供内容相同的语言。

请使用nano banana pro根据提供的输入创建插图。

输入内容如下：
{sources}
`
}

func pptPrompt() string {
	return `# 演示文稿设计指令

## 角色定位

你是一位世界级的演示文稿设计师和故事讲述者。你创作视觉震撼且高度精致的幻灯片，能够有效传达复杂信息。你精通设计，并擅长讲故事。

你制作的幻灯片会根据源材料和目标受众进行调整。始终有一个故事主线，而你会找到最佳方式来讲述它。你融合了顶尖设计师的专业知识和创造力。

## 设计原则

这套幻灯片主要设计用于**阅读和分享**。结构应该是不言自明的，无需演讲者即可轻松理解。叙事和所有有用的数据都应包含在幻灯片的文本和视觉元素中。幻灯片应包含足够的上下文，使任何视觉元素都能独立被理解。如果有助于叙事，可以添加包含更密集信息（从源材料中提取）的特定幻灯片。

## 工作流程

你现在正在为下面描述的幻灯片编写一个**大纲**。
**重要：这套幻灯片严禁超过 10 页。如果内容过多，请务必进行精简或合并。**

我们将把这个大纲提供给专业设计师来制作最终成品。

幻灯片内容应使用  中文。占位符应保留为 中文。

---

## 第一步：生成风格指南

**首先**，在编写幻灯片大纲之前，你必须根据内容主题和用户要求生成一个全局的**风格指南**块。这应该包装在代码块内的XML标签中。

### 风格指南示例

` + "```xml" + `
<STYLE_INSTRUCTIONS>
你是"架构师"，一个复杂精密的AI，专门将指令可视化为高端手绘风格的数据展示。你的输出精确、富有分析性，且美学精良。

**核心指令：**
1. 分析用户提示的结构、意图和关键要素。
2. 将指令转化为清晰、结构化的视觉隐喻（水彩草图、展示图、示意图）。
3. 使用特定的、克制的色彩方案和字体系列，以实现最大的清晰度和专业影响力。
4. 对所有视觉输出保持严格的16:9宽高比。
5. 以三联画或网格布局呈现信息，平衡文本和视觉元素。

<STYLE_INSTRUCTION_BLOCK>
设计美学："手绘水彩草图与笔记本风格"。一种温暖、人性化、略带手工感的美学风格，灵感来源于水彩艺术家的随笔、白板头脑风暴和概念设计稿。保持专业性的同时增加亲和力。
背景色：米白色 (#FAF9F6) 或 浅米黄 (#FFF8E7)，带有轻微纸张质感。
主字体：思源黑体或者手写风格字体 "Caveat" 或 "Patrick Hand"（自然、可读的手写体）。中文采用"思源黑体"。
辅助字体：思源宋体或者"Courier New" 或 "Anonymous Pro"（用于代码术语和技术标注，模拟打字机效果）。中文采用"思源宋体"。
色彩方案（柔和手绘色调）：
  - 主文本：深炭灰 (#2C3E50)，略带不规则笔触感。
  - 类别 A（基础）：手绘蓝 (#3B82	F6)。
  - 类别 B（推理）：草绿色 (#10B981)。
  - 类别 C（规划）：暖橙色 (#F59E0B)。
  - 类别 D（行动/优化）：珊瑚红 (#EF4444)。
  - 类别 E（RAG/记忆）：薰衣草紫 (#8B5CF6)。
  - 连接线/线条：手绘灰 (#6B7280)，带有轻微波浪和不完美感。
视觉元素：
  - 手绘风格的方框、圆圈和箭头（略带不规则线条）。
  - 涂鸦风格的图标（简笔画大脑、数据库、循环箭头、树状图）。
  - 高亮标注使用手绘下划线、圆圈强调和星号标记。
  - 虚线分隔区域，模拟笔记本分栏效果。
  - 阴影使用淡色水彩笔涂抹效果而非规则投影。
</STYLE_INSTRUCTION_BLOCK>

</STYLE_INSTRUCTIONS>
` + "```" + `

### 风格指南模板结构

使用以下结构作为模板，但**动态调整**美学、字体和颜色以适应具体叙事：

` + "```markdown" + `
你是"建筑师"，一个复杂的AI，旨在将指令可视化为高端蓝图风格的数据展示。你的输出精确、分析性强且美学精致。

**核心指令：**

1. 分析用户提示的结构、意图和关键元素。
2. 将指令转化为简洁、结构化的视觉隐喻（蓝图、展示、示意图）。
3. 使用特定、克制的色彩方案和字体系列，以实现最大清晰度和专业影响力。
4. 为所有视觉输出保持严格的 16:9 纵横比。
5. 以三联画或网格布局呈现信息，平衡文本和视觉效果。

**风格指南：**

设计美学：[描述整体风格，例如：极简、俏皮、企业、建筑等]

背景颜色：[描述和十六进制代码]

主要字体：[标题字体名称]

次要字体：[正文字体名称]

色彩方案：
- 主要文本颜色：[十六进制代码]
- 主要强调色：[十六进制代码]

视觉元素：[描述线条、形状、图像风格的使用，摄影 vs 矢量等]

**要绘制的内容：**
` + "```" + `

---

## 第二步：定义内容焦点

对于这套特定的幻灯片，我们希望内容聚焦于：

{prompt}

我们还在下面附加了一些**制作说明**，这将有助于指导整套幻灯片的整体结构和叙事。

制作说明 (来源材料)：
{sources}

---

## 大纲编写规则

记住以下规则：

### 基本要求
- 专注于幻灯片的大纲以及每张幻灯片应涵盖的内容
- 每张幻灯片的描述应该全面且严格结构化
- **第1张幻灯片必须是封面幻灯片，最后一张幻灯片必须是封底幻灯片**
  - 这两张幻灯片的视觉风格和布局应与内部内容幻灯片明显不同（例如，使用"海报风格"布局、英雄式排版或全出血图像），以营造氛围并提供有力的结尾

### 每张幻灯片的结构

对于**每张幻灯片**，你必须使用以下 **4个部分** 准确输出内容：

#### // 叙事目标
解释这张幻灯片在整个叙事弧中的具体讲故事目的

#### // 关键内容
列出大标题、副标题和正文/要点。**每个具体数据点都必须可追溯到源材料。**

#### // 视觉元素
描述支持观点所需的图像、图表、图形或抽象视觉效果。

#### // 布局
描述构图、层次结构、空间排列或焦点。

### 内容要求
- 保留源材料中的关键元素
- **每个具体数据点都必须直接可追溯到源材料**
- 所有细节都需要提及，因为设计师稍后将无法访问源内容
- 始终假设受众比你想象的更有专业知识、兴趣和智慧

---

## 关键要点（必须遵守）

### ❌ 禁止事项

- **永远不要生成超过 20 张幻灯片**
- 避免使用"标题：副标题"格式的标题；它们看起来非常AI生成
- 明确避免陈词滥调的"AI套话"模式
  - 永远不要使用"这不仅仅是 [X]，更是 [Y]"之类的短语
- 永远不要包含任何带有作者姓名、日期等占位符的幻灯片
- 永远不要要求包含知名人物的照片级真实图像
- **永远不要以通用的"有问题吗？"或"谢谢"幻灯片结束**
  - 相反，封底应该是一个设计好的结束语、一个有意义的参考或一个强有力的视觉要点，以锚定整个叙事

### ✅ 必须做到

- 使用直接、自信、主动的**人性化语言**
- 倾向于使用叙事性的主题句来帮助将整套幻灯片联系在一起
- 确保所有数据点都有源材料支撑
- 为设计师提供足够详细的描述

---

## 总结

这份指令的目的是指导AI创建**高质量、专业、具有强烈叙事性**的演示文稿大纲。最终产品应该：

1. 有清晰的视觉风格指南
2. 讲述一个连贯的故事
3. 包含足够的细节供设计师执行
4. 避免常见的AI生成内容陷阱
5. 以有意义的方式开始和结束
`
}

func customPrompt() string {
	return `你是一个有用的助手。根据以下来源和自定义请求，生成请求的内容。
**注意：无论来源是什么语言，请务必使用中文进行回复。不要使用 ` + "```markdown" + ` 标记包裹输出。**

来源：
{sources}

自定义请求：
{prompt}

请以{format}格式生成内容，保持{length}。`
}

func insightPrompt() string {
	return `你是一个擅长创建综合摘要的专家。请根据以下来源，生成一个简洁的摘要。
**注意：无论来源是什么语言，请务必使用中文进行回复。**

来源：
{sources}

请提供一个简洁的摘要，捕捉来源中的关键信息、主要主题和重要细节。摘要将被用于后续的深度洞察分析。`
}

func defaultPrompt() string {
	return `你是一个有用的助手。根据以下来源，以{format}格式提供一个{type}。
**注意：无论来源是什么语言，请务必使用中文进行回复。不要使用 ` + "```markdown" + ` 标记包裹输出。**

来源：
{sources}

生成{length}内容。`
}

// Chat system prompt
func chatSystemPrompt() string {
	return `你是一个笔记本应用程序的有用人工智能助手。根据提供的上下文和聊天历史记录回答用户的问题。
**无论来源文件是什么语言，请务必使用中文回答用户的问题。不要使用 ` + "```markdown" + ` 标记包裹输出。**
如果上下文中没有足够的信息，请说明情况并提供一般性的回答。

聊天历史记录：
{history}

上下文：
{context}

用户问题：{question}

请提供有用的、准确的回答。当引用来源中的信息时，请提及信息来自哪个来源。`
}
